{{#if chromeDisabled}}
  {{#unless error}}
    {{outlet}}
  {{else}}
    {{error-page error=error}}
  {{/unless}}
{{else if miniChrome}}
  {{#nypr-mini-chrome}}
    {{#unless error}}
      {{outlet}}
    {{else}}
      {{error-page error=error}}
    {{/unless}}
  {{/nypr-mini-chrome}}
{{else}}
  {{#site-chrome headerDonateChunk=headerDonateChunk beta=beta isHomepage=isHomepage currentPath=currentPath}}
    {{#unless error}}
      {{outlet}}
    {{else}}
      {{error-page error=error}}
    {{/unless}}
  {{/site-chrome}}
{{/if}}


{{#nypr-player-integration as |integration|}}
  {{#liquid-unless showPlayer class="nypr-player-wrapper"}}
  {{#unless chromeDisabled}}
    <div class="l-fixed l-lowright">
    {{nypr-player.queue-button
        isFloating  = true
        queueLength = audio.queue.items.length
        showModal   = (action 'showModal' 'queue-history')
        closeModal  = (action 'closeModal')
        isOpenModal = modal}}
    </div>
  {{/unless}}
  {{else}}
    {{#nypr-player
        currentTitle          = integration.currentTitle
        backdropImageUrl      = integration.backdropImageUrl
        onPlay                = integration.onPlay
        onPause               = integration.onPause
        onDismissNotification = integration.onDismissNotification
        revealNotificationBar = integration.revealNotificationBar
      as |content|}}

        {{#content.for 'trackInfo'}}
          {{nypr-player-integration.track-info
            showTitle      = integration.showTitle
            showUrl        = integration.showUrl
            showUrlTarget  = integration.showUrlTarget
            storyTitle     = integration.storyTitle
            storyUrl       = integration.storyUrl
            storyUrlTarget = integration.storyUrlTarget
            audioId        = integration.audioId
            songDetails    = integration.songDetails
          }}

          {{#if hifi.duration}} {{! only show the share button when the audio has loaded}}
            {{share-button
              story        = integration.currentAudio
              type         = (if integration.isAudiostream 'stream' 'ondemand')
              region       = "Player"
              text         = "SHARE"}}
          {{/if}}
        {{/content.for}}

        {{#content.for 'streamInfo'}}
          {{nypr-player.stream-info
            streamScheduleUrl       = integration.streamScheduleUrl
            streamScheduleUrlTarget = integration.streamScheduleUrlTarget
            streamPlaylistUrl       = integration.streamPlaylistUrl
            streamPlaylistUrlTarget = integration.streamPlaylistUrlTarget
            streamUrl               = integration.streamUrl
            streamUrlTarget         = integration.streamUrlTarget
            streamName              = integration.streamName
            streamsIndexUrl         = integration.streamsIndexUrl
            streamsIndexUrlTarget   = integration.streamsIndexUrlTarget
          }}
        {{/content.for}}

        {{#content.for 'action' as |args|}}
          {{args.queueButton
              queueLength       = audio.queue.items.length
              showModal         = (action 'showModal' 'queue-history')
              closeModal        = (action 'closeModal')
              isOpenModal       = modal}}
        {{/content.for}}

        {{#content.for 'notification'}}
          {{! This is just the message, the dismiss handler and the flag to show this message is above}}
          {{autoplay-notification duration=audio.duration position=audio.position audioType=currentAudio.audioType}}
        {{/content.for}}
    {{/nypr-player}}
  {{/liquid-unless}}
{{/nypr-player-integration}}
{{#liquid-if modal class="modal-wrapper sliding-modal"}}
  {{#x-modal closeModal=(action 'closeModal')}}
    {{component modal}}
  {{/x-modal}}
{{/liquid-if}}
